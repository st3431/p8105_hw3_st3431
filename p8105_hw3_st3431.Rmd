---
title: "p8105_hw3_st3431"
output: github_document
date: "2022-10-14"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

## Problem 2
```{r}
accel_df= read_csv("hw3_data/accel_data.csv") %>% 
  janitor::clean_names()
```

```{r}
accel_tidy= 
  accel_df %>% 
  pivot_longer(
    activity_1:activity_1440, 
    names_to = "minutes",
    values_to= "count"
  ) %>% 
  separate(minutes, into=c("delete", "time")) %>% 
  select(-delete) %>% 
   mutate( 
        across(.col= c(time), as.integer)) %>% 
  mutate(
    weekday_v_weekend = 
      case_when (day== "Monday" ~ "weekday", 
                day=="Tuesday"~ "weekday", 
                day== "Wednesday" ~ "weekday", 
                day=="Thursday" ~ "weekday", 
                day== "Friday" ~ "weekday",
                day== "Saturday" ~ "weekend", 
                day== "Sunday" ~ "weekend"), 
    day= factor(day, levels= c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday")))
     

accel_tidy %>% 
  summarize(
    n_obs= n()
  )

accel_tidy %>% 
  dim()
```

Within the tidied data set the key variables are week, day_id, day, minutes, count and the weekday v weekend variable. The dimensions of the tidied set are 50400 rows by 6 columns. 

Creating a table showing total activity for each day 

```{r}
accel_tidy %>% 
  group_by(day) %>% 
  summarize(total_activity= sum(count, na.rm=TRUE)) %>% 
  knitr::kable(caption= "Total Activity by Day")
```

From this table one trend that can be seen is how Wednesday through Friday, the later half of the week, has a higher activity count than the weekend, which Saturday has the lowest activity count. 


Creating a single panel plot 

```{r}
accel_tidy %>% 
  group_by(day, time) %>% 
  ggplot(aes(x=time, y=count, color=day), alpha= 0.5) +
  geom_point() + 
  theme(legend.position= "bottom") +
  labs(
    title= "24-hour Activity Time Courses for Each Day", 
    x= "hour in the day", 
    y= "count (min)",
    caption= "Data from Columbia University Medical Center"
  )
```

## Problem 3 

```{r}
library(p8105.datasets)
library(hexbin)
library(patchwork)
data("ny_noaa")
```

Tidying the data 

```{r}
ny_noaa_tidy= 
  ny_noaa %>% 
  janitor::clean_names() %>% 
  separate(date, c("year", "month", "day"), sep= "-") %>% 
  mutate( month= month.name[as.integer(month)], 
          year= as.integer(year), 
          prcp= as.numeric(prcp)/ 10,
          tmax= as.numeric(tmax)/10, 
          tmin= as.numeric(tmin)/ 10)

ny_noaa_tidy %>% 
  group_by(snow) %>% 
  summarize(n=n()) %>% 
  filter(min_rank(desc(n)) < 2 )
```

The most commonly observed values for snowfall was 0 inches which makes sense because the months which it snows are often less than the months it does not snow (warmer months versus months cold enough to have snow) 









